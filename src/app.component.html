<div class="min-h-screen flex flex-col">
  <!-- Navbar / Header -->
  <header class="bg-white border-b border-slate-200 sticky top-0 z-40 shadow-sm">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex items-center justify-between h-16">
        
        <!-- Logo -->
        <div class="flex items-center gap-2">
          <div class="w-8 h-8 bg-indigo-600 rounded-lg flex items-center justify-center text-white">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"/><path d="M15 2H9a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V3a1 1 0 0 0-1-1Z"/></svg>
          </div>
          <h1 class="text-xl font-bold text-slate-800 tracking-tight">Catatan<span class="text-indigo-600">Pro</span></h1>
        </div>

        <!-- Desktop Actions -->
        <div class="hidden md:flex items-center gap-4">
           <!-- Search -->
           <div class="relative">
             <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
               <svg class="h-4 w-4 text-slate-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/></svg>
             </div>
             <input 
               type="text" 
               placeholder="Cari catatan..." 
               (input)="handleSearch($event)"
               class="pl-10 pr-4 py-2 bg-slate-100 border-none rounded-full text-sm focus:ring-2 focus:ring-indigo-500 focus:bg-white transition-all w-64"
             >
           </div>
           
           <button (click)="downloadJson()" class="text-slate-500 hover:text-indigo-600 font-medium text-sm flex items-center gap-1 transition-colors">
             <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" x2="12" y1="15" y2="3"/></svg>
             Ekspor JSON
           </button>
        </div>

        <!-- Mobile Menu Button (simplified) -->
        <button class="md:hidden p-2 text-slate-600">
           <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/></svg>
        </button>
      </div>
      
      <!-- Mobile Search (visible only on small screens) -->
      <div class="md:hidden pb-4">
        <input 
          type="text" 
          placeholder="Cari catatan..." 
          (input)="handleSearch($event)"
          class="w-full pl-4 pr-4 py-2 bg-slate-100 border-none rounded-lg text-sm focus:ring-2 focus:ring-indigo-500"
        >
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="flex-grow max-w-7xl w-full mx-auto px-4 sm:px-6 lg:px-8 py-8">
    
    <!-- Filters -->
    <div class="flex flex-wrap gap-2 mb-8">
      <button 
        (click)="setFilter(null)" 
        class="px-4 py-1.5 rounded-full text-sm font-medium transition-all"
        [class.bg-slate-800]="selectedCategoryFilter() === null"
        [class.text-white]="selectedCategoryFilter() === null"
        [class.bg-white]="selectedCategoryFilter() !== null"
        [class.text-slate-600]="selectedCategoryFilter() !== null"
        [class.shadow-sm]="selectedCategoryFilter() !== null"
      >
        Semua
      </button>
      <button 
        (click)="setFilter('personal')" 
        class="px-4 py-1.5 rounded-full text-sm font-medium transition-all"
        [class.bg-green-600]="selectedCategoryFilter() === 'personal'"
        [class.text-white]="selectedCategoryFilter() === 'personal'"
        [class.bg-white]="selectedCategoryFilter() !== 'personal'"
        [class.text-slate-600]="selectedCategoryFilter() !== 'personal'"
        [class.shadow-sm]="selectedCategoryFilter() !== 'personal'"
      >
        Pribadi
      </button>
      <button 
        (click)="setFilter('work')" 
        class="px-4 py-1.5 rounded-full text-sm font-medium transition-all"
        [class.bg-blue-600]="selectedCategoryFilter() === 'work'"
        [class.text-white]="selectedCategoryFilter() === 'work'"
        [class.bg-white]="selectedCategoryFilter() !== 'work'"
        [class.text-slate-600]="selectedCategoryFilter() !== 'work'"
        [class.shadow-sm]="selectedCategoryFilter() !== 'work'"
      >
        Pekerjaan
      </button>
      <button 
        (click)="setFilter('idea')" 
        class="px-4 py-1.5 rounded-full text-sm font-medium transition-all"
        [class.bg-amber-500]="selectedCategoryFilter() === 'idea'"
        [class.text-white]="selectedCategoryFilter() === 'idea'"
        [class.bg-white]="selectedCategoryFilter() !== 'idea'"
        [class.text-slate-600]="selectedCategoryFilter() !== 'idea'"
        [class.shadow-sm]="selectedCategoryFilter() !== 'idea'"
      >
        Ide
      </button>
       <button 
        (click)="setFilter('todo')" 
        class="px-4 py-1.5 rounded-full text-sm font-medium transition-all"
        [class.bg-purple-600]="selectedCategoryFilter() === 'todo'"
        [class.text-white]="selectedCategoryFilter() === 'todo'"
        [class.bg-white]="selectedCategoryFilter() !== 'todo'"
        [class.text-slate-600]="selectedCategoryFilter() !== 'todo'"
        [class.shadow-sm]="selectedCategoryFilter() !== 'todo'"
      >
        Tugas
      </button>
    </div>

    <!-- Empty State -->
    @if (filteredNotes().length === 0) {
      <div class="text-center py-20 animate-in fade-in duration-500">
        <div class="w-24 h-24 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-6 text-slate-300">
          <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="12" x2="12" y1="18" y2="12"/><line x1="9" x2="15" y1="15" y2="15"/></svg>
        </div>
        <h3 class="text-lg font-medium text-slate-900 mb-1">Belum ada catatan</h3>
        <p class="text-slate-500 max-w-sm mx-auto mb-8">
          Mulai tambahkan catatan baru atau coba ubah kata kunci pencarian Anda.
        </p>
        <button 
          (click)="openCreateForm()"
          class="inline-flex items-center px-6 py-3 border border-transparent text-sm font-medium rounded-full shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-all"
        >
          <svg class="-ml-1 mr-2 h-5 w-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd" />
          </svg>
          Buat Catatan Pertama
        </button>
      </div>
    }

    <!-- Grid Layout -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 pb-20">
      @for (note of filteredNotes(); track note.id) {
        <app-note-card 
          [note]="note"
          (onEdit)="openEditForm($event)"
          (onDelete)="handleDelete($event)"
        />
      }
    </div>
  </main>

  <!-- Floating Action Button (Mobile/Desktop) -->
  <button 
    (click)="openCreateForm()"
    class="fixed bottom-8 right-8 w-14 h-14 bg-indigo-600 text-white rounded-full shadow-lg hover:bg-indigo-700 hover:shadow-indigo-500/30 hover:scale-105 active:scale-95 transition-all flex items-center justify-center z-30"
    title="Tambah Catatan"
  >
    <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="12" x2="12" y1="5" y2="19"/><line x1="5" x2="19" y1="12" y2="12"/></svg>
  </button>

  <!-- Modal Form -->
  @if (showForm()) {
    <app-note-form 
      [editingNote]="editingNote()"
      (save)="handleSave($event)"
      (cancel)="closeForm()"
    />
  }
</div>